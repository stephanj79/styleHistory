/* stylehistory.js v.1.0.2
 ** http://stephanjaeger-public.sharepoint.com
 ** stephan@stephanjaeger.onmicrosoft.com
 ** https://github.com/stephanj79/styleHistory
 ** https://www.npmjs.com/package/stylehistory
 ** Live-demo: http://jsfiddle.net/stephanj79/g7631mhf/
 ** Copyright (c) 2015 Stephan JÃ¤ger
 ** Available under the MIT license
 ** https://github.com/stephanj79/styleHistory/blob/master/LICENSE-MIT
 */
if("undefined"== typeof jQuery)throw new Error("stylehistory.js requires jQuery");
+function(a){
    "use strict";
    var b=a.fn.jquery.split(" ")[0].split(".");
    if(b[0]<1&&b[1]<11||1==b[0]&&11==b[1]&&b[2]<2)throw new Error("stylehistory.js requires jQuery version 1.11.2 or higher")
}(jQuery), jQuery.fn.stylehistory=function(a){
    function b(){
        $.each($("."+o),function(a,b){
            if(b.children.length>0){
                var c="",d="";
                $.each(b.children,function(a,b){
                    if(b.className==p&&(F||(c=b.innerHTML)), b.className==q){
                        F&&(F= !1, E.push({
                            m:d,
                            t:D
                        }), D=[]), d=b.innerHTML;
                        for(var e=b.nextElementSibling; null!=e;){
                            if(e.className==q){
                                F= !0;
                                break
                            }
                            e=e.nextElementSibling
                        }
                        var f=b.nextElementSibling;
                        if(f.className==r&&(D.push(f.innerHTML), null!=f.nextElementSibling))for(; null!=f.nextElementSibling&&f.nextElementSibling.className==r&&null!=f.nextElementSibling;)f=f.nextElementSibling, D.push(f.innerHTML)
                    }
                    b.className==r&&(F||(0==D.length&&0==E.length&&D.push(b.innerHTML), 0==E.length&&(E.push({
                        m:d,
                        t:D
                    }), D=[])))
                }), D.length>0&&E.push({m:d,t:D}), C.push({y:c,m:E}), D=[], E=[]
            }
        })
    }

    function c(){"dot"==m.marker?j=y:"arrow"==m.marker&&(j=m.reverseYear?A:z)}

    function d(){c(), $.each(C,function(a,b){0==m.itemCount?(k=b.y, $("."+n).append(j+'<div class="'+s+'"><div class="'+t+'">'+k+'</div><div class="'+u+k+'"></div>'+B+"</div>"), $.each(b.m,function(a,b){l=b.m, $("."+u+k).append('<div class="'+w+k+'"><div class='+w+k+"-month"+l+'><div class="'+x+'">'+(void 0==b.m?"":b.m)+"</div></div></div>"), $.each(b.t,function(a,b){$("."+w+k+"-month"+l).append('<div class="'+w+k+"-text"+l+'">'+(void 0==b?"":b)+"</div>")})})):a<m.itemCount&&(k=b.y, $(".style-history").append(j+'<div class="'+s+'"><div class="'+t+'">'+k+'</div><div class="'+u+k+'"></div>'+B+"</div>"), $.each(b.m,function(a,b){l=b.m, $("."+u+k).append('<div class="'+w+k+'"><div class='+w+k+"-month"+l+'><div class="'+x+'">'+(void 0==b.m?"":b.m)+"</div></div></div>"), $.each(b.t,function(a,b){$("."+w+k+"-month"+l).append('<div class="'+v+k+"-text"+l+'">'+(void 0==b?"":b)+"</div>")})}))}), $("."+t).css({"float":"left"}), $("."+u).css({"float":"left"})}

    function e(a,b){return b-a}

    function f(a,b){return a-b}

    function g(){
        C.sort(function(a,b){
            var c;
            return c=m.reverseYear?f(parseInt(a.y),parseInt(b.y)):e(parseInt(a.y),parseInt(b.y))
        })
    }

    function h(){
        $.each(C,function(a,b){
            b.m.length>1&&b.m.sort(function(a,b){
                var c;
                return c=m.reverseMonth?f(parseInt(a.m),parseInt(b.m)):e(parseInt(a.m),parseInt(b.m))
            })
        }), C.sort(function(a,b){
            var c;
            return c=f(parseInt(a.y),parseInt(b.y))
        })
    }

    function i(){$("."+o).remove()}

    $(window).resize(function(){
        var a=$("."+n).width;
        a>$(window).width&&($("."+n).width=$(window).width)
    });
    var j,k,l,m=jQuery.extend({
        chronologically:!0,
        reverseYear:!1,
        reverseMonth:!1,
        itemCount:0,
        marker:"dot"
    },a),n="style-history",o="style-history-item",p="style-history-item-year",q="style-history-item-month",r="style-history-item-text",s="style-history-inner-item",t="style-history-inner-item-year",u="style-history-inner-item-month",v="style-history-inner-item-mo-inner",w="style-history-inner-item-month-inner",x="style-history-inner-item-month-inner-month",y='<div class="dot"></div>',z='<div class="arrow up"></div>',A='<div class="arrow down"></div>',B='<div class="septor"></div>',C=[],D=[],E=[],F=!1;
    return this.each(function(){$(this).length>0&&(b(), m.chronologically&&(h(), g()), d(), i())})
};